# This application hosts the interactive map and radar.  
import http.server
import socketserver
import os

PORT = 8050
MAP_DIR = "D:/Aeonix/Core/map"

class NoCacheRequestHandler(http.server.SimpleHTTPRequestHandler):
    def end_headers(self):
        # ðŸš« Prevent browser caching
        self.send_header("Cache-Control", "no-cache, no-store, must-revalidate")
        self.send_header("Pragma", "no-cache")
        self.send_header("Expires", "0")
        super().end_headers()

    def log_message(self, format, *args):
        # Optional: cleaner console output
        print(f"[MAP REQUEST] {self.address_string()} - {self.path}")

if __name__ == "__main__":
    os.chdir(MAP_DIR)
    with socketserver.TCPServer(("", PORT), NoCacheRequestHandler) as httpd:
        print(f"âœ… Serving Aeonix map on http://localhost:{PORT}")
        print(f"ðŸ“‚ Directory: {MAP_DIR}")
        try:
            httpd.serve_forever()
        except KeyboardInterrupt:
            print("\nðŸ‘‹ Shutting down map server.")
